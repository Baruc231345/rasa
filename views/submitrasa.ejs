<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/rasa.css">
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
</head>

<body>
  <div class="container">
    <header>Summary Rasa Form</header>
      <form name="myForm" onsubmit="return false;" id="form">
      <div class="form first">
        <div class="details personal">
          <span class="title">Personal Details</span>

          <div class="fields1">
            <div class="input-field">
              <label>Full Name</label>
              <input type="text" id="full_name" value="<%= datainputted.full_name %>" disabled >
            </div>

            <div class="input-field">
              <label>Contact Number </label>
              <input type="text" id="contact_number" value="<%= datainputted.contact_number %>" disabled>
            </div>

            <div class="input-field">
              <label>Requestor Information</label>
              <input type="text" id="requestor_information" value="<%= datainputted.requestor_information %>" disabled>
            </div>

            <div class="input-field">
              <label>Requestor Type </label>
              <input type="text" id="requestor_type" value="<%= datainputted.requestor_type %>" disabled>
            </div>

          </div>
          </div>
        </div>
      <div class="form second">
        <div class="details personal">
          <span class="title">Event Information</span>

          <div class="fields2">
            <div class="input-field">
              <label>Event Name</label>
              <input type="text" id="event_name" value="<%= datainputted.event_name %>" disabled>
            </div>

            <div class="input-field">
              <label>Event Date/Day</label>
              <input type="date" id="event_day" value="<%= datainputted.event_day.toISOString().split('T')[0] %>" onchange="formatDate()" disabled>
            </div>

            <div class="input-field">
              <label>Event Description</label>
              <input type="text" id="event_description" value="<%= datainputted.event_description %>" disabled>
            </div>

            <div class="input-field">
              <label>Expected Participants</label>
              <input type="number" id="participants" value="<%= datainputted.participants %>" disabled>
            </div>

            <div class="input-field">
              <label>Purpose/Objective</label>
              <input type="text" id="purpose_objectives" value="<%= datainputted.purpose_objectives %>" disabled>
            </div>

            <div class="input-field">
              <label>How many days do you require use of the facility?</label>
              <input type="text" id="required_day" value="<%= datainputted.required_day %>"disabled >
            </div>

            <div class="input-field">
              <label>Start Time</label>
              <input type="time" id = "start_time" value="<%= datainputted.start_time %>"disabled>
            </div>

            <div class="input-field">
              <label>End Time</label>
              <input type="time" id="end_time" value="<%= datainputted.end_time %>"disabled>
            </div>
            </div>  


        <div class="mid">
          <div class="top">
          <span class="title">Facilities Needed</span>
          <p class="text">*please check all rooms/facilities you plan to use</p>
          <div class="fields3">
            <div class="row1">
            <label for="myRadioId" class="radio">
              <input type="checkbox" name="myRadioField" id="myRadioId" value="<%= datainventory.auditorium %>" class="radio_input" disabled <% if (datainventory.auditorium === 1) { %>checked<% } %>>
              <div class="radio_radio"></div>
              Auditorium 
            </label>
          </div>
          <div class="row2">
            <label for="myRadioId4" class="radio">
              <input type="checkbox" name="myRadioField" id="myRadioId4" value = "<%= datainventory.foodandbeverage %>" class="radio_input" disabled <% if (datainventory.foodandbeverage === 1) { %>checked<% } %>>
              <div class="radio_radio"></div>
              Food and Beverage Room
            </label>          
          </div>
          <div class="row3">        
            <label for="myRadioId7" class="radio">
              <input type="checkbox" name="myRadioField" id="myRadioId7" value = "<%= datainventory.mainlobby %>" class="radio_input" disabled <% if (datainventory.mainlobby === 1) { %>checked<% } %>>
              <div class="radio_radio"></div>
              Main Lobby
            </label>
            <div class="row7">
            <label for="myRadioId5" class="radio">
              <input type="checkbox" name="myRadioField" id="myRadioId5" value = "<%= datainventory.dancestudio %>" class="radio_input" disabled <% if (datainventory.dancestudio === 1) { %>checked<% } %>>
              <div class="radio_radio"></div>
              Dance Studio 
            </label>
          </div>
            </div>
              <div class="row4">
                <label for="myRadioId1" class="radio">
                  <input type="checkbox" name="myRadioField" id="myRadioId1" value = "<%= datainventory.multihall %>" class="radio_input" disabled <% if (datainventory.multihall === 1) { %>checked<% } %>>
                  <div class="radio_radio"></div>
                  Multi Purpose Hall
                </label>
              </div>
              <div class="row5">
                <label for="myRadioId2" class="radio">
                  <input type="checkbox" name="myRadioField" id="myRadioId2" value = "<%= datainventory.gym %>" class="radio_input" disabled <% if (datainventory.gym === 1) { %>checked<% } %>>
                  <div class="radio_radio"></div>
                  Gymnasium
                </label>
              </div>
              <div class="row6">
                <label for="myRadioId3" class="radio">
                  <input type="checkbox" name="myRadioField" id="myRadioId3" value = "<%= datainventory.classroom %>" class="radio_input" disabled <% if (datainventory.classroom === 1) { %>checked<% } %>>
                  <div class="radio_radio"></div>
                  Classrooms
                </label>
              </div>
        <div class="row7">
        <label for="myRadioId6" class="radio">
        <input type="checkbox" name="myRadioField" id="myRadioId6" value = "<%= datainventory.kitchen %>" class="radio_input" disabled <% if (datainventory.kitchen === 1) { %>checked<% } %>>
        <div class="radio_radio"></div>
        Kitchen Area
            </label>
        </div>
        </div>
          </div>

          <div class="details personal">
            <span class="title">Equipment Needed</span>
            <p class="text">*please check all equipment you plan to use</p>
            <div class="fields4">
              
              <p class="text1">MIS/IT</p>
              <label for="myRadioId_1" class="radio2">
                <input type="checkbox" name="myRadioField" id="myRadioId_1" value = "<%= datainventory.sound_system %>" class="radio_input1" disabled <% if (datainventory.sound_system === 1) { %>checked<% } %>>
                <div class="radio_radio1"></div>
                Sound System

                <div class="input-wide">
                  <input type="text" placeholder="Number of Sound System" id="sound-system_input" value = "<%= datainventory.sound_system_quantity %>" disabled>
                </div>         
              </label>
  
              <label for="myRadioId_2" class="radio2">
                <input type="checkbox" name="myRadioField" id="myRadioId_2" value = "<%= datainventory.microphone %>" class="radio_input1" disabled <% if (datainventory.microphone === 1) { %>checked<% } %>>
                <div class="radio_radio1"></div>
                Microphone
                <div class="input-wide">
                  <input type="text" placeholder="Number of Microphone" id="microphone_input" value = "<%= datainventory.microphone_quantity %>" disabled>
                </div>   
              </label>
  
              <label for="myRadioId_3" class="radio2">
                <input type="checkbox" name="myRadioField" id="myRadioId_3" value = "<%= datainventory.lcd %>" class="radio_input1" disabled <% if (datainventory.lcd === 1) { %>checked<% } %>>
                <div class="radio_radio1"></div>
                LCD Projector
                <div class="input-wide">
                  <input type="text" placeholder="Number of Lcd Projector" id="lcd-projector_input" value = "<%= datainventory.lcd_quantity %>" disabled>
                </div>    

              </label>
  
              <label for="myRadioId_4" class="radio2">
                <input type="checkbox" name="myRadioField" id="myRadioId_4" value = "<%= datainventory.widescreen %>" class="radio_input1" disabled <% if (datainventory.widescreen === 1) { %>checked<% } %>>
                <div class="radio_radio1"></div>
                Widescreen
                <div class="input-wide">
                  <input type="text" placeholder="Number of Sound System" id="wide-screen_input" value = "<%= datainventory.widescreen_quantity %>" disabled>
                </div> 
              </label>
            </div>

            <div class="fields5">
              <p class="text1">Bag</p>
              
              <label for="myRadioId-1" class="radio3">
                <input type="checkbox" name="myRadioField" id="myRadioId-1" value = "<%= datainventory.chair %>" class="radio_input2" disabled <% if (datainventory.chair === 1) { %>checked<% } %>>
                <div class="radio_radio2"></div>
                Chair/s

                <div class="input-wide">
                  <input type="text" placeholder="Number of Chair/s" id="chair_input" value = "<%= datainventory.chair_quantity %>" disabled>
                </div>    
          
              </label>
  
              <label for="myRadioId-2" class="radio3">
                <input type="checkbox" name="myRadioField" id="myRadioId-2" value = "<%= datainventory.table_input %>" class="radio_input2" disabled <% if (datainventory.table_input === 1) { %>checked<% } %>>
                <div class="radio_radio2"></div>
                Table/s

                <div class="input-wide">
                  <input type="text" placeholder="Number of Table/s" id="table_input" value = "<%= datainventory.table_quantity %>" disabled>
                </div>    
              </label>

              <div class="row3">
              <label for="myRadioId-3" class="radio3">
                <input type="checkbox" name="myRadioField" id="myRadioId-3" value = "<%= datainventory.blackpanel %>" class="radio_input2" disabled <% if (datainventory.blackpanel === 1) { %>checked<% } %>>
                <div class="radio_radio2"></div>
                Black Panel

                <div class="input-wide">
                  <input type="text" placeholder="Number of Black Panel" id="black-panel_input" value = "<%= datainventory.blackpanel_quantity %>" disabled>
                </div>  
              </label>
  
              <label for="myRadioId-4" class="radio3">
                <input type="checkbox" name="myRadioField" id="myRadioId-4" value = "<%= datainventory.whiteboard %>" class="radio_input2" disabled <% if (datainventory.whiteboard === 1) { %>checked<% } %>>
                <div class="radio_radio2"></div>
                Whiteboard
             
                <div class="input-wide">
                  <input type="text" placeholder="Number of Whiteboard" id="whiteboard_input" value = "<%= datainventory.whiteboard_quantity %>" disabled>
                </div>  
              </label>
              <div class="aircon">
                <label for="myRadioId-6" class="radio3">
                  <input type="checkbox" name="myRadioField" id="myRadioId-6" value = "<%= datainventory.aircon %>" class="radio_input2" disabled <% if (datainventory.aircon === 1) { %>checked<% } %>>
                  <div class="radio_radio2"></div>
                  Aircon Time
                </label>
              
                <div class="input-aircon">
                  <input type="time" placeholder="Start of Aircon Time" id="start-time" value = "<%= datainventory.start_aircon %>" disabled>
                </div>
              
                <p class="text1">to</p>
              
                <div class="input-aircon">
                  <input type="time" placeholder="End of Aircon Time" id="end-time" value = "<%= datainventory.end_aircon %>" disabled>
                </div>
              </div>

                
                <div class="input-other">
                  <label for="myRadioId-7" class="radio3">
                    <input type="checkbox" name="myRadioField" id="myRadioId-7" value = "<%= datainventory.other %>" class="radio_input2" disabled <% if (datainventory.other === 1) { %>checked<% } %>>
                    <div class="radio_radio2"></div>
                    Other: 
                  </label>
                
                  <input type="text" placeholder="Other/s" id="otherInput" value = "<%= datainventory.other_quantity %>"disabled>
                </div>
              </div>
        </div>
        </div>
            </div>
            <div class="buttons">
              <button type="submit" id="btnSubmit">Submit</button>
              <button type="button" id="btnBack" onclick="handleClick()">Back</button>
            </div>
          </div>
          <div class="form fourth" style="height: 500px;">
            <% if (datainputted.form_sign) { %>
              <div id="form_sign">
                <img src="data:image/png;base64, <%= datainputted.form_sign.toString('base64') %>" >
                <div id="text_signature">Venue Approval</div>
              </div>
            <% } else { %>
              <div id="form_sign"></div>
              <div id="text_signature">Venue Approval</div>
            <% } %>
            
            <% if (datainputted.form_sign2) { %>
              <div id="form_sign2">
                <img src="data:image/png;base64, <%= datainputted.form_sign2.toString('base64') %>" >
                <div id="text_signature2">Osa Approval</div>
              </div>
            <% } else { %>
              <div id="form_sign2"></div>
              <div id="text_signature2">Osa Approval</div>
            <% } %>
          </div>
  
      </form>
</body>
<script>const universalId = <%= JSON.stringify(universalId) %>;

  function handleClick() {
    window.location.href = "/rasa"
  }

  function formatDate() {
    const eventDayInput = document.getElementById("event_day");
    const selectedDate = eventDayInput.value;
    const dateObject = new Date(selectedDate);
    const year = dateObject.getFullYear();
    const month = String(dateObject.getMonth() + 1).padStart(2, "0");
    const day = String(dateObject.getDate()).padStart(2, "0");
    const formattedDate = `${year}-${month}-${day}`;
    eventDayInput.value = formattedDate;
  }
  
  document.getElementById('btnSubmit').addEventListener('click', function () {
      const rasatesting2 = {
        user_id: universalId,
        full_name: document.getElementById('full_name').value,
        event_name: document.getElementById('event_name').value,
        event_description: document.getElementById('event_description').value,
        event_day: document.getElementById('event_day').value,
        start_time: document.getElementById('start_time').value,
        end_time: document.getElementById('end_time').value,
        contact_number: document.getElementById('contact_number').value,
        requestor_information: document.getElementById('requestor_information').value,
        requestor_type: document.getElementById('requestor_type').value,
        participants: document.getElementById('participants').value,
        required_day: document.getElementById('required_day').value,
        purpose_objectives: document.getElementById('purpose_objectives').value,
      };
      console.log(rasatesting2 + "this is rasatesting2 json");

      fetch("/api/rasatesting2", {
        method: "POST",
        body: JSON.stringify(rasatesting2),
        headers: {
          "Content-type": "application/json"
        }
      })
        .then(response => response.json())
        .then(data => {
          const insertedId = data.id;
          const inventory= {
            inventory_id: insertedId,
            auditorium: document.getElementById('myRadioId').checked ? 1 : 0,
            foodandbeverage: document.getElementById('myRadioId4').checked ? 1 : 0,
            multihall: document.getElementById('myRadioId1').checked ? 1 : 0,
            dancestudio: document.getElementById('myRadioId5').checked ? 1 : 0,
            gym: document.getElementById('myRadioId2').checked ? 1 : 0,
            classroom: document.getElementById('myRadioId3').checked ? 1 : 0,
            kitchen: document.getElementById('myRadioId6').checked ? 1 : 0,
            mainlobby: document.getElementById('myRadioId7').checked ? 1 : 0,
            sound_system: document.getElementById("myRadioId_1").checked ? 1 : 0,
            sound_system_quantity: document.getElementById("sound-system_input").value,
            microphone: document.getElementById("myRadioId_2").checked ? 1 : 0,
            microphone_quantity: document.getElementById("microphone_input").value,
            lcd: document.getElementById("myRadioId_3").checked ? 1 : 0,
            lcd_quantity: document.getElementById("lcd-projector_input").value,
            widescreen: document.getElementById("myRadioId_4").checked ? 1 : 0,
            widescreen_quantity: document.getElementById("wide-screen_input").value, 
            chair: document.getElementById("myRadioId-1").checked ? 1 : 0, 
            chair_quantity: document.getElementById("chair_input").value,
            table_input: document.getElementById("myRadioId-2").checked ? 1 : 0,
            table_quantity: document.getElementById("table_input").value,
            blackpanel: document.getElementById("myRadioId-3").checked ? 1 : 0,
            blackpanel_quantity: document.getElementById("black-panel_input").value,
            whiteboard: document.getElementById("myRadioId-4").checked ? 1 : 0,
            whiteboard_quantity: document.getElementById("whiteboard_input").value,
            aircon: document.getElementById("myRadioId-6").checked ? 1 : 0,
            start_aircon: document.getElementById("start_time").value,
            end_aircon: document.getElementById("end_time").value,
            other: document.getElementById("myRadioId-7").checked ? 1 : 0,
            other_quantity: document.getElementById("otherInput").value,
            };
          console.log(inventory + "this is rasatesting2_inventory json");
          fetch("/api/rasatesting2_inventory", {
            method: "POST",
            body: JSON.stringify(inventory),
            headers: {
              "Content-type": "application/json"
            }
          })
            .then(response => response.json())
            .then(data => {
              alert("Your Rasa Submission is successfully submitted!");
              setTimeout(function () {
                window.location.href = `/rasaview/${universalId}`;
              }, 3000);
            })
            .catch(error => {
              console.error(error);
            });
        })
        .catch(error => {
          console.error(error);
        });
    });
  </script>
</body>
</html>